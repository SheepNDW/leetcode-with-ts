## 3381. Maximum Subarray Sum With Length Divisible by K

本題要求找一個子陣列，使：
1. 子陣列的長度可以被 `k` 整除
2. 子陣列的元素和最大

### 解法一：暴力解 (Brute Force) - TLE

#### 思路

1. 先建立前綴和陣列 `prefix`，其中 `prefix[i] = nums[0] + nums[1] + ... + nums[i]`
2. 枚舉所有起點 `i`，對於每個起點，枚舉所有長度為 `k` 的倍數的終點 `j`
3. 子陣列 `nums[i..j]` 的和為 `prefix[j] - prefix[i-1]`

#### 複雜度

- **時間複雜度**：$O(n \times \frac{n}{k})$
- **空間複雜度**：$O(n)$（前綴和陣列）

### 解法二：前綴和 + 餘數分組優化

#### 思路

關鍵觀察：如果子陣列 `nums[i..j]` 的長度 `(j - i + 1)` 要能被 `k` 整除，等價於：

$$
(j + 1) \mod k = (i) \mod k
$$

也就是說，前綴長度 `j + 1` 和 `i` 對 `k` 取餘數要相同。

#### 推導

設 `presum[i]` 為前 `i+1` 個元素的和（即 `nums[0..i]` 的和）。

子陣列 `nums[i..j]` 的和為：
$$
\text{sum} = \text{presum}[j] - \text{presum}[i-1]
$$

為了最大化這個值，我們需要**最小化** `presum[i-1]`。

#### 餘數分組

我們將所有前綴按照**長度對 `k` 的餘數**分組：

- `minPrefix[r]`：紀錄所有長度 `% k === r` 的前綴和中的**最小值**

在遍歷過程中：
- 當前位置 `i`，前綴長度為 `i + 1`，餘數為 `r = (i + 1) % k`
- 我們要找的是「長度餘數也是 `r`」的最小前綴和
- 這樣才能保證子陣列長度 `(i + 1) - 某個長度` 是 `k` 的倍數

#### 初始化

`minPrefix[0] = 0`：代表「空前綴」，長度為 0，和為 0，餘數為 0。

這是必要的，因為當子陣列就是 `nums[0..j]`（長度為 `k` 的倍數）時，我們需要用到這個空前綴。

#### 演算法流程

```
初始化 minPrefix[0] = 0，其餘為 Infinity
presum = 0
res = -Infinity

對於每個位置 i：
  1. presum += nums[i]           // 累加當前元素
  2. r = (i + 1) % k             // 計算當前前綴長度的餘數
  3. res = max(res, presum - minPrefix[r])  // 嘗試更新答案
  4. minPrefix[r] = min(minPrefix[r], presum)  // 更新該餘數的最小前綴和
```

#### 為什麼先更新答案再更新 minPrefix？

因為我們要找的是**嚴格在當前位置之前**的最小前綴和。如果先更新 `minPrefix[r]`，可能會導致子陣列長度為 0 的情況。

#### 複雜度

- **時間複雜度**：$O(n)$
- **空間複雜度**：$O(k)$

#### 舉例說明

以 `nums = [1, 2, -1, 4, 5]`, `k = 2` 為例：

| i   | nums[i] | presum | r = (i+1)%k | minPrefix[r] | res 更新    |
| --- | ------- | ------ | ----------- | ------------ | ----------- |
| 0   | 1       | 1      | 1           | ∞            | 1 - ∞ = -∞  |
| 1   | 2       | 3      | 0           | 0            | 3 - 0 = 3   |
| 2   | -1      | 2      | 1           | 1            | 2 - 1 = 1   |
| 3   | 4       | 6      | 0           | 0            | 6 - 0 = 6   |
| 4   | 5       | 11     | 1           | 1            | 11 - 1 = 10 |

答案為 10，對應子陣列 `[2, -1, 4, 5]`（長度 4，可被 2 整除）。
